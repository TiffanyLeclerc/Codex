# 需求說明：
在特定時機（1.編審後／2.初核前／3.退件後／4.月退休金案續發案件執行整批續發作業前／5.取消月核後），承辦人員因特定原因（如匯款資料異動、受款人死亡等）需要修改基本資料、受款人、繼承人及案件記事的資料，查詢核定函、請領核發資料、請領其他給付資料、勞退個人異動查詢及個人專戶明細資料，並產出報表及記錄更正軌跡以提供「更正日誌」顯示。

# 作業流程說明：
承辦人員以「請領種類」與「受理編號」作為查詢條件，檢核案件狀態是否符合 1～5 項任一條件；
若符合則導頁至「資料修改頁」，可於「基本資料／受款人／案件記事」三頁籤進行資料修改，其餘頁籤僅供顯示；
於分頁切換時，三個可編輯頁籤會先行儲存並於切換後帶出最新資料；
在「基本資料」頁籤勾選「民法繼承案件」時，受款人頁籤會出現繼承人資料區塊，並帶入「死亡日期」與「民法繼承案件」資訊；
資料修改完成後按「確認」，回寫資料並進行重新編審。

# 狀態與限制補充說明
- 狀態可更正條件：僅限下列任一狀態的案件可進入資料修改頁並允許更正。
  - 1：已編審後
  - 2：未初核（初核前）
  - 3：已退件
  - 4：月退休金案續發案件執行整批續發作業前
  - 5：取消月核後
- 整批續發限制：若請領種類為 32/42/46/52/53 且已執行整批續發，該案件不可更正，按「確認」返回查詢頁並顯示「本案件無法進行更正，請確認案件狀態」。
- 功能可編輯範圍：僅「基本資料／受款人／案件記事」三頁籤可更正，其餘頁籤僅提供顯示且不進行任何資料庫更新。

# 功能操作說明：
- [操作流程]:
  1) 進入「更正作業」查詢頁（op6.html），輸入條件後點「確認」。
  2) 條件檢核通過且案件狀態符合，導頁至「資料修改頁」（op6_edit*.html）。
  3) 於「基本資料／受款人／案件記事」三頁籤進行必要更正，其餘頁籤僅顯示。
  4) 點「確認」回寫並重新編審；或依需要執行頁首其他功能（列印、審核、金額分割、註銷本案、返回等）。

## 頁面: 查詢條件頁（op6.html）
- [頁面標題]: 更正作業
- [區塊]: 條件輸入
  - [欄位]: *請領種類
    - [類型]: 下拉式選單
    - [選項]: 提前請領退休金(31)、提前請領月退休金(32)、一次退休金(41)、月退休金(42)、續提退休金(43)、續提月退休金(46)、死亡退休金(51)、月退死亡退休金(52)、死亡退休金(含月退)(53)
    - [驗證]: 未選擇時按下「確認」顯示「請選擇請領種類」。
  - [欄位]: *受理編號
    - [類型]: 複合文字輸入（5 子欄位，以「-」分隔）
    - [子欄位規則]:
      - 1: 長度3、僅數字
      - 2: 長度1、僅數字
      - 3: 長度2、僅數字
      - 4: 長度6、僅數字
      - 5: 選填；若有填須長度2、僅數字
    - [互動]: 子欄位達 maxlength 時，自動跳至下一輸入。
    - [驗證]: 長度不符顯示「受理編號錯誤」。
- [區塊]: 按鈕區
  - [按鈕]: 確認
    - [動作]: 檢核所有可見欄位合法性。
    - [錯誤提示]:
      - 查無案件：顯示「查無可更正的案件資料」。
      - 狀態不符（非 1～5）：顯示「本案件無法進行更正，請確認案件狀態」。
      - 指定請領種類（32/42/46/52/53）且已執行整批續發：顯示相同訊息。
    - [通過後導頁]: 前往資料修改頁。
    - [傳遞資料]:
      - [來源: 條件頁.請領種類] -> [目標: 資料修改頁]
      - [來源: 條件頁.受理編號] -> [目標: 資料修改頁.來源受理編號]
  - [按鈕]: 清除
    - [動作]: 清空「請領種類」「受理編號」欄位。

## 頁面: 資料修改頁（op6_edit*.html）
- [頁籤]:
  - 基本資料（可編輯）
  - 受款人（可編輯）
  - 核定函（顯示）
  - 請領核發資料（顯示）
  - 請領其他給付資料（顯示）
  - 勞退個人異動查詢（顯示）
  - 個人專戶明細資料（顯示）
  - 案件記事（可編輯）
- [分頁切換規則]:
  - 於「基本資料／受款人／案件記事」間切換時，先行儲存並於切換後帶出最新資料。
  - 「基本資料」勾選「民法繼承案件」時，如該受理案件無任何繼承人，需先自動轉至「受款人」新增繼承人。
  - 分頁切換的儲存為可部分成功：僅針對目前頁籤可編輯且通過驗證的欄位進行更新；未通過驗證者以紅字訊息提示且不更新該欄位。
- [顯示條件（民法繼承案件）]:
  - 「民法繼承案件」checkbox 僅於請領種類為 51/52/53 且「勞工死亡日期」有值時顯示；否則不顯示。
  - 勾選後若該受理案件尚無任何繼承人，系統自動轉至「受款人」頁籤以新增繼承人。
- [頁首按鈕]:
  - [確認]: 回寫資料並進行重新編審。
  - [受理審核清單列印]：僅在提交成功（版次+1）且無未提交變更、無驗證錯誤、版本一致時啟用；否則禁用。
  - [審核]
  - [金額分割]（僅於「受款人」頁籤且請領種類為 51/52/53 顯示）
  - [註銷本案]
  - [頁面(或pdf)列印]
  - [返回]：如存在未提交變更（dirty 狀態），須提示確認是否放棄未儲存資料。
- [顯示區塊]:
  - 請領種類（唯讀顯示）
  - 受理編號、版次、申請次數等（依原型顯示）

## 全域樣式／驗證／排版
- [全域樣式規則]: 欄位名稱前「*」為必要欄位，星號以紅色顯示。
- [全域驗證規則]: 欄位名稱前「*」為必要輸入欄位。
- [全域操作規則]: 任一輸入或下拉選單按 Tab／Enter 依序跳至下一可輸入元件。
- [全域排版規則]:
  - 欄位名稱（Label）尾端自動加全形「：」。
  - 標籤靠左、輸入框緊接其後，呈水平排列；視窗 1028×768 內超出則自動換行。
  - 若需避免被 Bootstrap 覆蓋，採用自訂 class（例如 .size-auto）調整 width。
  - 禁用 Bootstrap 做欄位排版；採自訂彈性排版。
  - 版面原則：一列三個欄位為固定原則，若該請領類別沒有該欄位，則由其他欄位補上。

## 輸入格式與驗證補強
- 日期欄位（7 碼民國年月日，例：1130615 或 0600101）
  - 格式：`YYYMMDD`，Y 為民國年三位數；M 為 01–12；D 需符合該月有效日期（含閏年檢核）。
  - 邏輯：
    - 「申請日期」不得早於「勞工出生日期」，不得晚於系統日（可同日）。
    - 「本局收到日期」不得晚於系統日；如為月退相關（32/42/46），不得早於「申請日期」。
    - 「勞工死亡日期」如存在，須晚於「勞工出生日期」且不得晚於系統日。
- 數字欄位
  - 僅允許半形數字；金額欄位不得為負值；必要時四捨五入位數以畫面標註為準。
  - `#retirement-service-years` 僅允許 0–99；空值等同 0。
- 身分證字號欄位
  - 須符合格式檢核（首字英文字母 + 9 碼數字，含檢核碼）；若為外籍/無身分證者，依現制允許留空或以規格外代碼處理（顯示對應提示）。
- 民法繼承案件勾選規則
  - 當勾選「民法繼承案件」且請領種類為 51/52/53 時，受款人頁籤必須至少存在 1 位繼承人；否則切換或確認時提示並自動導至受款人頁籤。
  - 取消勾選時，如已存在繼承人，需彈出確認對話框說明將不再視為繼承案件（僅移除繼承案件旗標，不自動刪除既有繼承人資料）。

## 儲存、重新編審與錯誤處理補強
- 分頁自動儲存：在三個可編輯頁籤間切換時，系統先執行當前頁籤可見欄位檢核，通過者以交易更新；失敗者在欄位下方以紅字輕量訊息顯示並自動捲動至第一個錯誤欄位。
- 確認（提交）
  - 動作順序：
    1) 針對三個可編輯頁籤執行整體驗證。
    2) 全數通過後，以單一交易提交所有異動至資料庫。
    3) 產生更正日誌（詳如下）並觸發重新編審流程。
  - 失敗路徑：任一驗證失敗或資料庫更新失敗，整筆提交回滾；在對應頁籤標示錯誤並保留使用者輸入。
  - 成功回饋：顯示提交成功訊息；若重新編審需要時間，顯示背景處理提示與狀態查詢連結（如適用）。

## 更正日誌（Audit Trail）規格
- 記錄時機：
  - 分頁切換儲存：僅記錄實際變更之欄位。
  - 按下「確認」提交：以提交前後差異為準，彙總記錄本次變更快照。
- 記錄內容（每一欄位一筆）
  - 受理編號、請領種類、版次
  - 頁籤名稱、欄位代碼（對應畫面 id 或內部欄位碼）、欄位顯示名稱
  - 變更前值、變更後值
  - 使用者帳號、使用者姓名
  - 操作時間（精確至秒）
  - 操作類型（auto-save/submit）與變更批次識別碼（同一提交共用）
- 檢視：更正日誌供後續「更正日誌」畫面查詢顯示（本功能不含檢視 UI）。

## 版本控制與併發處理
- 版次欄位（`#display-version`）作為前端顯示，後端採用樂觀鎖控制：
  - 更新時攜帶目前資料版本；若版本不符則拒絕更新並回傳「資料已被他人更新，請重新載入」訊息。
  - 使用者可選擇重載最新資料或覆蓋（若業務允許）。
- 分頁自動儲存亦須納入版本檢核，避免跨分頁造成覆寫。

## 受款人與繼承人補充規則
- 法定代理人欄位在請領人未成年或依法須代理時才為必填；否則可留空。
- 新增繼承人
  - `#heir-id`、`#heir-dob` 等欄位需同樣套用身分證與日期檢核；關係（`#heir-relation`）為必填。
  - 地址欄位在選擇地址類型後才開放輸入（如原型所示 disabled -> enabled）。
- 核發方式變更可能影響後續撥付流程，提交前須提示影響並要求確認（如系統已串接撥付模組）。

## 按鈕與導覽補強
- [受理審核清單列印]：依目前資料即時產製列印畫面（或 PDF）；不應觸發資料更新。僅在使用者於任一可編輯頁籤按下「確認」且提交成功（版本+1）後才啟用；若存在未提交變更（dirty 狀態）、驗證錯誤或版本不一致時須禁用。
- [審核]：進入或觸發準備初核流程；僅在案件狀態允許時顯示或可點擊。
- [金額分割]：導向金額分割作業；進入前如有未提交變更，需先提交或提示放棄變更。
- [註銷本案]：需再次確認並檢核是否符合註銷條件；成功後案件狀態更新，返回查詢頁。
- [返回]：如有未提交變更且尚未自動儲存，提示是否離開並可能遺失未儲存內容。

### 頁籤按鈕規則（顯示與可用條件）
- 共用規則
  - 編輯頁籤（基本資料／受款人／案件記事）顯示：確認、受理審核清單列印、審核、註銷本案、返回（頁面(或pdf)列印隱藏）。其中「受理審核清單列印」於載入時為禁用狀態，需「確認」提交成功後才啟用；若再次編輯產生未提交變更則自動恢復禁用。
  - 唯讀頁籤（核定函／請領核發資料／請領其他給付資料／勞退個人異動查詢／個人專戶明細資料）顯示：頁面(或pdf)列印、返回。
  - 分頁切換先嘗試儲存；當前頁籤驗證未通過時，需阻擋「確認／審核／註銷」等提交類行為。
  - 狀態限制：不符合可更正之狀態時，隱藏或禁用確認／審核／註銷／金額分割。
  - 權限限制：「審核」「註銷本案」需具備權限，否則禁用或隱藏。

- 基本資料（op6_edit.html）
  - 顯示：確認、受理審核清單列印、審核、註銷本案、返回。
  - 可用條件：
    - 確認：當前頁籤驗證通過。
    - 受理審核清單列印：本次會話已成功「確認」提交（版本+1）且無未提交變更/驗證錯誤/版本不符。
    - 審核：案件狀態允許且使用者具備權限。
    - 註銷本案：符合註銷條件且具備權限。

- 受款人（op6_edit2.html）
  - 顯示：確認、受理審核清單列印、審核、金額分割、註銷本案、返回。
  - 可用條件：
    - 確認／受理審核清單列印／審核／註銷本案：同基本資料頁規則（受理審核清單列印需已成功「確認」且無未提交變更）。
    - 金額分割：僅請領種類 51/52/53 顯示；且可分配總額 > 0 且清單內至少一位受款人時可用。

- 案件記事（op6_edit8.html）
  - 顯示：確認、受理審核清單列印、審核、註銷本案、返回。
  - 可用條件：
    - 確認：所有記事列通過必填驗證（日期、內容）。
    - 受理審核清單列印/審核/註銷本案：同基本資料頁規則（受理審核清單列印需已成功「確認」且無未提交變更）。

- 核定函（op6_edit3.html）
  - 顯示：頁面(或pdf)列印、返回。
  - 可用條件：
    - 頁面(或pdf)列印：預覽資料可生成（否則提示資料不足）。

- 請領核發資料（op6_edit4.html）
  - 顯示：頁面(或pdf)列印、返回。
  - 可用條件：
    - 頁面(或pdf)列印：表格資料載入完成。

- 請領其他給付資料（op6_edit5.html）
  - 顯示：頁面(或pdf)列印、返回。
  - 可用條件：
    - 頁面(或pdf)列印：表格資料載入完成。

- 勞退個人異動查詢（op6_edit6.html）
  - 顯示：頁面(或pdf)列印、返回。
  - 可用條件：
    - 頁面(或pdf)列印：清單或明細載入完成。

- 個人專戶明細資料（op6_edit7.html）
  - 顯示：頁面(或pdf)列印、返回。
  - 可用條件：
    - 頁面(或pdf)列印：明細與統計資料載入完成。

## 頁籤與顯示欄位配置（共同區塊與各頁籤顯示區）

- 共同區域（所有頁籤上方）
  - 請領種類（唯讀顯示）

- 基本資料（op6_edit.html）
  - 顯示區塊（頁籤內上方）：受理編號、版次、申請次數、緊急、法院扣押、居住國內、網路申辦
  - 條件顯示：
    - 緊急：顯示於 31/41/43/51/53。
    - 法院扣押：顯示於 51/52/53。
    - 居住國內：顯示於 31/32/41/42/43/46。
    - 網路申辦：顯示於 31/32/41/42/43/46。

- 受款人（op6_edit2.html）
  - 顯示區塊（頁籤內上方）：受理編號、版次、勞工姓名、勞工身分證字號、勞工出生日期
  - 條件顯示：
    - 勞工死亡日期：顯示於 51/52/53。
    - 民法繼承案件：顯示於 51/52/53。
    - 核定金額：顯示於 51/52/53。
    - 請領人數：顯示於 51/52/53。

- 核定函（op6_edit3.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、版次、格式
  - 條件顯示：無（恆顯示上述欄位）。

- 請領核發資料（op6_edit4.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、版次
  - 條件顯示：無（恆顯示上述欄位）。

- 請領其他給付資料（op6_edit5.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、版次
  - 條件顯示：無（恆顯示上述欄位）。

- 勞退個人異動查詢（op6_edit6.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、版次
  - 條件顯示：無（恆顯示上述欄位）。

- 個人專戶明細資料（op6_edit7.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、版次、已繳納金額、收益累計、可核發金額
  - 條件顯示：無（恆顯示上述欄位）。

- 案件記事（op6_edit8.html）
  - 顯示區塊（頁籤內上方）：受理編號、勞工姓名、勞工身分證字號、勞工出生日期、勞工死亡日期、申請日期、緊急、法院扣押、版次、申請次數
  - 條件顯示：
    - 勞工死亡日期：僅於請領種類 51/52/53 且「死亡日期」有值時顯示。
    - 申請日期：恆顯示（依案件申請日帶入）。
    - 緊急：顯示於 31/41/43/51/53。
    - 法院扣押：顯示於 51/52/53。
    - 版次、申請次數：恆顯示（對應目前案件版本與申請次數）。

備註
- 共同區域僅顯示「請領種類」，其餘欄位均配置於各頁籤的顯示區塊。
- 各頁籤的顯示區塊置於該頁籤內容最上方、功能/編輯表單之前（一致化視覺與導覽）。
- 條件顯示欄位（如核定金額/請領人數）須以請領種類控制可見性。

## 按鈕動作：失敗路徑與傳遞資料
- [查詢頁.確認]
  - [失敗路徑]: 顯示對應錯誤訊息（請領種類／受理編號／案件狀態），自動捲動至錯誤欄位。
  - [成功路徑]: 導頁資料修改頁，並透過 URL 參數傳遞「請領種類／受理編號」。
- [查詢頁.清空]
  - [成功路徑]: 清空欄位並聚焦回第一欄位。

## 欄位清單：基本資料（op6_edit.html）
- 顯示欄位（唯讀）
  - 請領種類: `#display-claim-type`
  - 受理編號: `#display-case-id`
  - 版次: `#display-version`
  - 申請次數: `#display-apply-count`
  - 網路申辦: `#display-online-apply`（可見：31,32,41,42,43,46）
  - 法院扣押: `#display-court-seizure`（可見：51,52,53）
- 可編輯欄位
  - 緊急: `#emergency-type`（select；可見：31,41,43,51,53）
  - 居住國內: `#residing-in-country`（select，必填；可見：31,32,41,42,43,46）
  - 勞工姓名: `#laborer-name`（input text，必填）
  - 勞工身分證字號: `#laborer-id`（input text，maxlength=10，必填）
  - 勞工出生日期: `#laborer-dob`（input text，maxlength=7，placeholder=「例: 0600101」，必填）
  - 申請日期: `#apply-date`（input text，maxlength=7，placeholder=「例: 1130615」，必填）
  - 勞工死亡日期: `#display-laborer-dod`（唯讀顯示；可見：31,41,43,51,52,53；UI 標籤含「*」為強調用途，非必填檢核）
  - 民法繼承案件: `#civil-law-inheritance`（checkbox；可見：51,52,53，且「勞工死亡日期」須有值）
  - 請領年限: `#display-claim-years`（唯讀顯示；可見：32）
  - 期數: `#display-installments`（唯讀顯示；可見：42,46,32,52）
  - 郵戳日期: `#display-postmark-date`（唯讀顯示；可見：51,52,53）
  - 判決日期: `#display-judgment-date`（唯讀顯示；可見：51,52,53）
  - 本局收到日期: `#bli-receipt-date`（input text，maxlength=7，必填；可見：32,42,46；預設值=「申請日期」）
  - 有無延壽年金: `#has-annuity`（select；可見：31,41,43）
  - 提供證明種類: `#proof-type`（select；可見：31,32）
  - 障礙程度: `#disability-level`（select；可見：31,32）
  - 障礙類別組: `.disability-input-2`、`.disability-input-1`（多組 input，無 id）
  - 退職服務年資: `#retirement-service-years`（input text，maxlength=2；可見：31,32,41,42,43,46）
  - 核定格式: `#approval-format`（input text）
  - 本金迄算年月: `#principal-calc-date`（input text，maxlength=7）
  - 本金迄算收益日期: `#earnings-calc-date`（input text，maxlength=7）
  - 月退核發起訖年月: `#display-monthly-pension-period`（唯讀顯示；可見：32,42,46,52）
  - 核定期(季)數: `#display-approved-periods`（唯讀顯示；可見：32,42,46,52）
  - 利率: `#display-interest-rate`（唯讀顯示；可見：32,42,46,52）
  - 每月核定金額: `#display-monthly-approved-amount`（唯讀顯示；可見：32,42,46,52）
  - 每季核定金額: `#display-quarterly-approved-amount`（唯讀顯示；可見：32,42,46,52）
  - 首發月退核定月數: `#display-first-payment-months`（唯讀顯示；可見：32,42,46,52）
  - 首發月退核定金額: `#display-first-payment-amount`（唯讀顯示；可見：32,42,46,52）
  - 設定扣押總額: `#total-seizure-amount`（input text；可見：51,52,53）
  - 回報扣押日期: `#report-seizure-date`（input text；可見：51,52,53）
  - 支付扣押金額: `#paid-seizure-amount`（input text；可見：51,52,53）
  - 扣押餘額: `#seizure-balance`（input text；可見：51,52,53）
  - 扣押欄位整體檢核：當任一扣押欄位填寫時，四欄位需互相一致（總額 = 支付 + 餘額）；日期須為有效日且不得晚於系統日。

### 實作規格（可直接開發）——基本資料
- 版面與行為
  - 一列三欄：`.flex-form-container` + `.flex-form-item`，必要欄位於 label 前加 `<span class="required">*</span>`。
  - 顯示控制：依 `data-claim-type-show` 決定顯示；`#civil-law-inheritance-container` 顯示需同時滿足請領種類與「勞工死亡日期」有值。
  - 自動儲存：input/select 的 change/blur 即寫入 state；切換頁籤時嘗試儲存，提交時總驗證與交易提交。
- 欄位規格與驗證
  - `#residing-in-country`：select，值域 {Y,N}，必填。
  - `#laborer-name`：text，maxlength=200，必填，不允許前後空白。
  - `#laborer-id`：text，maxlength=10，必填，轉大寫；本國身分證檢核（含檢核碼）。
  - 日期群（`#laborer-dob`、`#apply-date`、`#bli-receipt-date`、`#principal-calc-date`、`#earnings-calc-date`）：text，maxlength=7，格式 `YYYMMDD`，有效民國日；申請日期 ≥ 出生日期 且 ≤ 系統日；收到日期 ≤ 系統日；月退（32/42/46）之收到日期 ≥ 申請日期。
  - `#display-laborer-dod`：唯讀顯示，格式 `YYYMMDD`；可空。
  - `#civil-law-inheritance`：checkbox；首次勾選且繼承人數=0 → 導至受款人頁新增；取消勾選且已有繼承人 → 顯示確認（不刪資料）。
  - 障礙類別：10 組 `NN-N`（`.disability-input-2` + `.disability-input-1`），數字限定；未填可略。
  - 扣押群（`#total-seizure-amount`、`#report-seizure-date`、`#paid-seizure-amount`、`#seizure-balance`）：顯示於 51/52/53；若 `#display-court-seizure` ≠ 'Y' 則 disabled；金額為非負數字；日期為 `YYYMMDD`；任一有值則需滿足「總額=支付+餘額」。
- 前端遮罩與格式化（Basic）
  - 日期：僅允許數字；輸入框以 `YYYMMDD` 區段化顯示（可用 placeholder）；blur 時檢核與回填標準化字串。
  - 金額：僅允許數字與小數點；blur 時以千分位顯示，內部存 raw 數值字串；右對齊顯示。
  - 身分證：自動轉大寫；即時檢核長度與字元類型；blur 進行檢核碼驗證。
- 錯誤訊息鍵（Basic）
  - REQ_LABORER_NAME：請輸入勞工姓名。
  - REQ_LABORER_ID：請輸入身分證字號。
  - INV_LABORER_ID：身分證字號格式有誤。
  - REQ_DOB：請輸入出生日期。
  - INV_DATE_FORMAT：日期格式錯誤（YYYMMDD）。
  - INV_DATE_RANGE_APPLY_LT_DOB：申請日期不可早於出生日期。
  - INV_DATE_RANGE_APPLY_GT_TODAY：申請日期不可晚於系統日。
  - INV_DATE_RANGE_RCPT_GT_TODAY：本局收到日期不可晚於系統日。
  - INV_DATE_RANGE_RCPT_LT_APPLY：本局收到日期不可早於申請日期（限月退）。
  - INV_SEIZURE_SUM：扣押總額必須等於支付金額加餘額。
  - INV_NUMBER：數字格式錯誤。

## 欄位清單：受款人（op6_edit2.html）
- 顯示欄位（唯讀）
  - 受理編號: `#display-case-id`
  - 版次: `#display-version`
  - 勞工姓名: `#display-laborer-name`
  - 勞工身分證字號: `#display-laborer-id`
  - 勞工出生日期: `#display-laborer-dob`
  - 勞工死亡日期: `#display-laborer-dod`（僅 51/52/53 顯示）
  - 民法繼承案件: `#display-civil-law-inheritance`（僅 51/52/53 顯示）
  - 核定金額: `#display-approved-amount`（僅 51/52/53 顯示）
  - 請領人數: `#display-applicant-count`（僅 51/52/53 顯示）
- 受款人資料列表
  - 新增受款人: `#btn-add-beneficiary`（button；僅 51/52/53 顯示）
  - 受款人清單 tbody: `#beneficiary-table-body`
- 受款人資料維護（編輯區）
  - 請領人序: `#ben-seq`（唯讀顯示）
  - 請領人姓名: `#ben-name`（input text，必填）
  - 身分證字號: `#ben-id`（input text，maxlength=10，必填）
  - 出生日期: `#ben-dob`（input text，maxlength=7，必填）
  - 關係: `#ben-relation`（select，必填）
  - 電話: `#ben-phone`（input text）
  - 行動電話: `#ben-mobile`（input text）
  - 核發方式: `#ben-payout-method`（select，必填）
  - 地址類型: `#ben-address-type`（select，必填）
  - 郵遞區號/地址: `#ben-zip`、`#ben-address-city`、`#ben-address-district`、`#ben-address-street`（input/select，必填）
  - 帳號（核發方式=1/2/7/8 顯示）: `#ben-account-branch`、`#ben-account-bank`、`#ben-account-number`、及複驗 `#ben-account-branch-2`、`#ben-account-bank-2`、`#ben-account-number-2`（皆必填）
  - 國外收款資訊（核發方式=5 顯示）
    - 受款人英文姓名: `#foreign-name`
    - SWIFT Code: `#foreign-swift`
    - 銀行名稱: `#foreign-bank-name`
    - 銀行地址: `#foreign-bank-address`
    - 國外收款帳號: `#foreign-account`
    - 國別: `#foreign-addr-country`
    - 城市/城鎮: `#foreign-addr-town`
    - 地址: `#foreign-addr-street`
  - 專戶註記（僅 31/32/41/42/43/46 顯示）: `#ben-special-account-note`
- 維護區按鈕
  - 確認: `#btn-save-beneficiary`
  - 清除: `#btn-clear-beneficiary-form`
  - 返回: `#btn-return-to-list`
- 受款人與法代欄位
  - 法定代理人姓名: `#legal-rep-name`（input text）
  - 法定代理人身分證字號: `#legal-rep-id`（input text，maxlength=10）
  - 法定代理人出生日期: `#legal-rep-dob`（input text，maxlength=7）
  - 與請領人關係: `#legal-rep-relation`（select）

- 金額分割（僅 51/52/53；按下頁首「金額分割」顯示 Modal）
  - Modal: `#amountSplitModal`、標題: `#amountSplitModalLabel`
  - 可分配總額: `#total-allocatable-amount`
  - 分割明細 tbody: `#split-table-body`
  - 確認分割: `#btn-split-confirm`
- 繼承人區（民法繼承案件相關）
  - 繼承人數: `#heir-count`（input text）
  - 新增繼承人: `#btn-add-heir`（button；可見：51,52,53）
  - 繼承人清單 tbody: `#heir-table-body`
  - 繼承人明細 Template 內欄位（有 id/或 class）
    - 申請人姓名: `#heir-name`（input text）
    - 身分證字號: `#heir-id`（input text）
    - 出生日期: `#heir-dob`（input text）
    - 關係: `#heir-relation`（select）
    - 電話: `#heir-phone`（input text）
    - 行動電話: `#heir-mobile`（input text）
    - 地址類型: `#heir-address-type`（select）
    - 郵遞區號: `#heir-zip`（input text，disabled 初始）
    - 縣市: `#heir-city`（select，disabled 初始）
    - 鄉鎮市區: `#heir-district`（select，disabled 初始）
    - 街路地址: `#heir-street`（input text，disabled 初始）
    - 核發方式: `#heir-payout-method`（select）
    - 帳號（核發方式=1/2/7/8 顯示）
      - 帳號分段：`#heir-account-branch`（3）`#heir-account-bank`（4）`#heir-account-number`（15）
      - 帳號分段(複驗)：`#heir-account-branch-2`（3）`#heir-account-bank-2`（4）`#heir-account-number-2`（15）

### 實作規格（可直接開發）——受款人與繼承人
- 受款人列表與維護
  - 列表欄位：序號、指定匯入帳號(checkbox)、關係、申請人姓名、身分證字號、可領金額、扣減金額、實發金額、操作（修改/刪除）。
  - 進入行為：當僅有 1 筆受款人資料時，預設直接展開維護區（顯示該筆明細），省略列表選擇步驟；當多筆時先顯示列表。
  - 維護必填：姓名、身分證、出生日期、關係、核發方式、地址類型、地址（郵遞區號/縣市/鄉鎮市區/街路），以及依核發方式展現之帳號/外匯欄位。
  - 地址啟用：選擇地址類型後，啟用郵遞區號/縣市/鄉鎮市區/街路；未選時 disabled。
  - 地址規則（與 prototype 對齊）：
    - `#ben-zip`：僅數字；maxlength=6；允許 3–6 碼；輸入後嘗試對應縣市/鄉鎮選項（資料集維護）；對應不到時提示「郵遞區號不存在」。
    - `#ben-address-city`/`#ben-address-district`：下拉選單；必選；依縣市決定鄉鎮清單；二者與郵遞區號需一致。
    - `#ben-address-street`：文字；maxlength=80；不可空白；允許常見符號（號/樓/之等）。
    - 驗證：三者與郵遞區號需一致（zip ↔ city/district 對應）；不一致顯示「郵遞區號與縣市/鄉鎮不一致」。
  - 地址類型預設與可編輯性：
    - 進入受款人維護時，地址類型預設為「戶籍地址」，此時所有地址欄位（郵遞區號/縣市/鄉鎮市區/街路）皆唯讀（disabled）。
    - 當使用者切換為「現住址」時，以上地址欄位即啟用並視為必填，需通過地址一致性與必填檢核。
    - 切回「戶籍地址」時：
      - 立即將地址欄位恢復唯讀（disabled），移除「必填」檢核，並清除現住址欄位上的錯誤訊息標示。
      - 已輸入但未提交的現住址內容保留於前端暫存（不送出、不檢核）；再次切回「現住址」時可復原以便續填。
      - 預設顯示的戶籍地址值為後端提供之唯讀戶籍資料，本頁不開放修改。
  - 指定匯入帳號唯一性：
    - 規則：同一時間僅允許一筆受款人被勾選為「指定匯入帳號」；勾選某列時自動取消其他列勾選。
    - 錯誤鍵：BEN_PRIMARY_ACCOUNT_REQUIRED（當核發方式需帳戶但未指定時）。
  - 核發方式 UI 限制與提示：
    - 當基本資料「緊急」= 專案處理時，核發方式清單僅顯示 7-緊急電匯；若原已選非 7，立即顯示提示並重置為空白（或 7），錯誤鍵 PAYOUT_EMERGENCY_ONLY_7。
    - 當「專戶註記」= 已提供專戶帳號時，核發方式僅允許 1/2；當「專戶註記」= 申請專戶時，僅允許 A；其餘選項在清單中隱藏或禁用；若原已選不符，立即顯示提示並重置，錯誤鍵 PAYOUT_CONFLICT_WITH_SPECIAL_NOTE。
    - 上述限制於變更來源欄位當下即時檢核與回饋（非僅提交時），以降低誤用；提交前再做一次整體檢核。
  - 連絡電話格式：
    - `#ben-phone`：允許數字、括號()、連字號- 與空白；maxlength=20。
    - `#ben-mobile`：10 碼台灣手機（09XXXXXXXX）或國際格式（+國碼開頭）；maxlength=20。
    - 錯誤鍵（選配）：PHONE_INVALID、MOBILE_INVALID。
  - 金額欄位顯示（列表中的金額列）：
    - 可領金額/扣減金額/實發金額以千分位、右對齊顯示；空值顯示策略需一致（建議顯示空白，計算時視為 0）。
  - Dirty 狀態：
    - 在維護區編輯任一欄位即標記為 dirty；成功按頁首「確認」提交後清除 dirty。
    - 當 dirty=true 時，「受理審核清單列印」按鈕禁用（與全域規則一致）。
  - 刪除與重排序號：
    - 刪除任一筆後，應重新編排序號（由 1 起連號）。
    - 刪除成功後，不自動重新編審；系統引導承辦人按「確認」執行重新編審。若未確認，列印/審核等提交類操作應受阻（依全域 dirty 規則）。

  - ZIP ↔ 縣市/鄉鎮 對應檢核（實作說明）
    - 以郵遞區號資料集對應縣市/鄉鎮。
    - 輸入郵遞區號達 3 碼即可開始嘗試對應；唯一對應時可自動帶出縣市與鄉鎮供使用者確認；多重對應時提醒使用者自行選擇。
    - 變更縣市時重建鄉鎮下拉；變更任一欄位後重新檢核三者一致性（zip ↔ city/district）。
    - 檢核失敗訊息：
      - 郵遞區號不存在
      - 郵遞區號與縣市/鄉鎮不一致
  - 專戶註記：僅 31/32/41/42/43/46 顯示，選項如原型（已提供專戶帳號/申請專戶）。
- 帳號一致性/驗證規則（受款人/繼承人共用）
  - 國內帳號（核發方式=1/2/7/8）：
    - 欄位：分支行(3)、銀行(4)、帳號(15)；皆僅數字；右對齊顯示；maxlength 依 prototype 分別為 3/4/15。
    - 複驗：三段欄位逐段一致；任一段不一致即報錯；錯誤鍵 ACC_RECHECK_MISMATCH。
    - 郵局 vs 銀行（需決策）：目前 prototype 對 1/2/7/8 同用 3/4/15；是否在核發方式=2（郵局）時強制銀行代碼=700？若需，請明定規則與錯誤鍵（如 BANK_CODE_POST_REQUIRED）。
    - 金融機構（方式=1）第二段固定：第 2 段（銀行代碼 4 碼）固定顯示 0000 且不可修改；由系統/後端回填顯示，不納入輸入檢核。
  - 國外匯款（核發方式=5）：
    - 受款人英文姓名：必填；英文字母與空白；maxlength=200。
    - SWIFT：必填；自動轉大寫英數；長度必須 8 或 11；maxlength 依 prototype=13（允許輸入後再檢核長度）；錯誤鍵 SWIFT_INVALID。
    - 銀行名稱/地址：必填；maxlength=200。
    - 國外帳號：必填；英數與有限特殊字元（-_/\. 空白）；maxlength 依 prototype=38；有效長度建議 4–34（仍接受至 38 以兼容）；錯誤鍵 FX_ACCOUNT_INVALID。
    - 國別/城市/地址：皆必填；城市 maxlength=100；地址 maxlength=150。

- 核發方式限制（與上游欄位連動）
  - 緊急案件：當基本資料「緊急」= 專案處理時，核發方式僅允許 7-緊急電匯；違反時顯示錯誤（PAYOUT_EMERGENCY_ONLY_7）。
  - 專戶註記：
    - 已提供專戶帳號 → 核發方式僅允許 1-金融機構 或 2-郵局。
    - 申請專戶 → 核發方式僅允許 A-郵寄支票。
    - 違反時顯示錯誤（PAYOUT_CONFLICT_WITH_SPECIAL_NOTE）。

- 主帳戶（指定匯入帳號）必要條件判定
  - 當受款人中存在任一筆核發方式屬於「需帳戶之類型」（1/2/5/7/8）時，必須指定一筆主帳戶；否則提示 BEN_PRIMARY_ACCOUNT_REQUIRED。
  - 若所有受款人核發方式皆為 3/4/A（非帳戶類型），則不強制指定主帳戶。

- 受款人頁籤「確認」後金額重算規則（與文件一致）
  - 動作：在受款人頁籤按下「確認」後，重算本頁之「可領金額／扣減金額／實發金額」。
  - 特別規則（死亡類 51/52/53）：若勾選「指定匯入帳號」，該筆受款人的可領金額=核定金額，其餘請領人之可領金額=0。
  - 成功提交後（版本+1）方可列印；若任一欄位被修改（dirty），需再次確認與重算。

- 金額分割（Modal）檢核（51/52/53）
  - 欄位：序號、申請人姓名、分配金額（或依 UI 僅開放金額）。
  - 檢核：各受款人「分配金額」加總必須等於「可分配總額」。
  - 不檢核百分比加總（避免除不盡問題）。如同時提供百分比欄位，僅作輔助顯示，不作檢核依據。
  - Modal 確認後：回寫分配結果至列表並標記 dirty；需按「確認」完成重新編審。
  - 繼承人（民法繼承案件）
  - 顯示條件：基本資料勾選「民法繼承案件」。
  - 元件：`#heir-count`、`#btn-add-heir`、`#heir-table-body`、`#heir-details-container`、`#heir-detail-template`。
  - 明細欄位：姓名、身分證、出生日期、關係(必填)、電話、行動電話、地址類型、郵遞區號/縣市/鄉鎮區/街路（初始 disabled，選類型後啟用）、核發方式與相依欄位（同受款人）。
  - 地址類型預設與可編輯性（繼承人）：
    - 首次開啟繼承人區塊時，地址類型預設為「戶籍地址」，其地址欄位（郵遞區號/縣市/鄉鎮市區/街路）皆唯讀（disabled）。
    - 當切換為「現住址」時，上述地址欄位啟用並視為必填，需通過地址一致性與必填檢核。
    - 切回「戶籍地址」時：
      - 立即將地址欄位恢復唯讀（disabled），移除「必填」檢核，並清除現住址欄位上的錯誤訊息標示。
      - 已輸入但未提交的現住址內容保留於前端暫存（不送出、不檢核）；再次切回「現住址」時可復原以便續填。
      - 顯示之戶籍地址值為後端提供之戶籍資料，本頁不開放修改。
  - 互動：新增一筆 → 展開明細區塊並於列表新增列；提供刪除；地址「同上」複製上一筆（heir 模板內 `.heir-addr-same-as-prev`）。
- 前端遮罩與格式化（受款人/繼承人）
  - 日期（出生）：僅數字；`YYYMMDD`；blur 檢核與正規化。
  - 身分證：轉大寫，長度與字元即時檢核；blur 檢核碼驗證。
  - 帳號：僅數字；自動聚焦到下一欄（達 maxlength 時）。
  - 金額（列表金額欄）：千分位顯示，右對齊。
- 錯誤訊息鍵（受款人/繼承人）
  - REQ_BEN_NAME / REQ_HEIR_NAME：請輸入姓名。
  - REQ_BEN_ID / REQ_HEIR_ID：請輸入身分證字號。
  - INV_ID：身分證字號格式有誤。
  - REQ_BEN_DOB / REQ_HEIR_DOB：請輸入出生日期。
  - INV_DATE_FORMAT：日期格式錯誤（YYYMMDD）。
  - REQ_RELATION：請選擇關係。
  - REQ_PAYOUT_METHOD：請選擇核發方式。
  - REQ_ADDRESS_TYPE：請選擇地址類型。
  - REQ_ADDRESS_FIELDS：請完整填寫郵遞區號/縣市/鄉鎮市區/街路。
  - REQ_ACCOUNT_SEGMENTS：請完整填寫帳號各段。
  - ACC_RECHECK_MISMATCH：帳號與複驗不一致。
  - SWIFT_INVALID：SWIFT 代碼格式錯誤（8 或 11 碼英數）。
  - FX_ACCOUNT_INVALID：國外帳號格式不符長度或非法字元。

## 欄位清單：案件記事（op6_edit8.html）
- 頁首按鈕（共用）
  - 確認: `#btn-confirm`
  - 受理審核清單列印: `#btn-print-checklist`
  - 審核: `#btn-prepare-approval`
  - 註銷本案: `#btn-cancel-case`
  - 返回: `#btn-return`
- 記事區
  - 新增記事: `#btn-add-note`（button）
  - 記事明細列（動態）
    - 日期: `input[data-field="date"]`（input text，maxlength=7，必填；預設帶入系統日之民國年月日）
    - 內容: `input[data-field="content"]`（input text，maxlength=50，必填）
    - 常用片語: `.btn-common-phrase`（button；僅對「新增行」顯示）
    - 刪除: `.btn-delete-note`（button）

### 實作規格（可直接開發）——案件記事
- 表格欄位：序號、日期、內容、操作（常用片語/刪除）。
- 新增：點擊「新增」於表尾新增一列，日期預設系統日民國年月日（`YYYMMDD`），顯示「常用片語」按鈕。
- 常用片語：
  - 僅針對新增列顯示按鈕；彈出 Popover 顯示片語清單與代碼輸入；選擇或輸入代碼後帶入內容。
  - 片語清單由系統提供；支援 Enter 快速套用；關閉後即時儲存 state。
- 刪除：點擊刪除顯示確認對話框，確認後移除列並重新編號。
- 前端遮罩與格式化（Notes）
  - 日期欄：僅允許數字；maxlength=7；blur 檢核（`YYYMMDD`）。
  - 內容欄：maxlength=50；禁止僅空白；可即時顯示剩餘字數（選配）。
- 驗證與錯誤鍵（Notes）
  - REQ_NOTE_DATE：請輸入記事日期。
  - INV_DATE_FORMAT：日期格式錯誤（YYYMMDD）。
  - REQ_NOTE_CONTENT：請輸入記事內容。

### 錯誤訊息鍵對照（可直接開發）
- 基本資料（常用）
  - `#laborer-name` → REQ_LABORER_NAME
  - `#laborer-id` → REQ_LABORER_ID, INV_LABORER_ID
  - `#laborer-dob` → REQ_DOB, INV_DATE_FORMAT
  - `#apply-date` → INV_DATE_FORMAT, INV_DATE_RANGE_APPLY_LT_DOB, INV_DATE_RANGE_APPLY_GT_TODAY
  - `#bli-receipt-date` → INV_DATE_FORMAT, INV_DATE_RANGE_RCPT_GT_TODAY, INV_DATE_RANGE_RCPT_LT_APPLY
  - `#residing-in-country` → REQ_RESIDING
  - 扣押群 → INV_NUMBER, INV_DATE_FORMAT, INV_SEIZURE_SUM

- 受款人/繼承人（常用）
  - 姓名 → REQ_BEN_NAME / REQ_HEIR_NAME
  - 身分證 → REQ_BEN_ID / REQ_HEIR_ID, INV_ID
  - 出生日期 → REQ_BEN_DOB / REQ_HEIR_DOB, INV_DATE_FORMAT
  - 關係 → REQ_RELATION
  - 核發方式 → REQ_PAYOUT_METHOD
  - 地址類型/地址 → REQ_ADDRESS_TYPE, REQ_ADDRESS_FIELDS
  - 帳號（國內） → REQ_ACCOUNT_SEGMENTS, ACC_RECHECK_MISMATCH
  - 外匯（國外） → SWIFT_INVALID, FX_ACCOUNT_INVALID

- 案件記事（Notes）
  - 日期 → REQ_NOTE_DATE, INV_DATE_FORMAT
  - 內容 → REQ_NOTE_CONTENT

### 即時格式化/遮罩規格（前端）
- 日期（所有日期欄位）
  - 僅允許 0–9；maxlength=7；blur 時校驗 `YYYMMDD`（民國年）。
  - 可選：輸入 7 碼後自動驗證，錯誤即顯示紅字訊息並聚焦。
- 年月（起訖年月等）
  - 僅允許 0–9；maxlength=5 或 6（依 UI）；格式 `YYYMM`；blur 時檢核。
- 金額與數字欄位
  - 僅允許數字與一個小數點；keyup 即時移除非數字字元；blur 以千分位顯示；右對齊。
  - 內部值以未格式化數字保存於 state，顯示層使用千分位。
- 身分證字號
  - keyup 自動轉大寫；限制第一碼英文字母、其餘數字；blur 執行檢核碼驗證。
- 帳號段（國內帳號）
  - 每段達 maxlength 自動跳至下一輸入；非數字即時移除；複驗欄位逐段即時比對，錯誤高亮顯示。
- 自動跳欄（受理編號/帳號等多段輸入）
  - 達 maxlength 時 focus 下一欄；Backspace 於空欄時回前欄（選配）。

### Prototype 實作補充說明（無程式碼）
- 欄位呈現：欄位以一列三欄排版（.flex-form-container/.flex-form-item）；必要欄位於標籤前顯示紅色星號；錯誤訊息以紅色輕量文字呈現於欄位下方。
- 事件時機：欄位 blur/change 觸發單欄檢核與狀態更新；切換頁籤前執行 Auto‑Save（僅更新通過驗證欄位）。
- 互動準則：達 maxlength 自動跳到下一輸入（受理編號/帳號等多段欄位）；Backspace 於空欄時可回前一欄（選配）；日期/金額/身分證採用前文「即時格式化/遮罩規格」。

## 其他唯讀頁籤欄位（逐頁詳列）
- 核定函（op6_edit3.html）
  - 共同抬頭區
    - 受理編號: `#display-case-id`
    - 勞工姓名: `#display-laborer-name`
    - 勞工身分證字號: `#display-laborer-id`
    - 勞工出生日期: `#display-laborer-dob`
    - 版次: `#display-version`
    - 格式: `#display-approval-format`
  - 核定函內容（預覽區；僅顯示）
    - 申請日期: `#applyDate`
    - 核定格式: `#approvalFormat`
    - 累計提繳年資: `#total-contribution-years`
    - 本金合計: `#total-principal`
    - 收益累計: `#total-earnings`
    - 保證收益: `#guaranteed-earnings`
    - 核定金額: `#approved-amount`
    - 收件人（姓名）: `#approval-letter-recipient`
    - 收件地址: `#approval-letter-address`
    - 主旨: `#approval-letter-subject`
    - 說明段落容器: `#approval-letter-description`
  - 欄位格式與對齊
    - 日期（申請日期）：民國年月日 `YYYMMDD`；右對齊。
    - 金額（本金合計、收益累計、保證收益、核定金額）：金額；千分位顯示；右對齊。
    - 年資（累計提繳年資）：以「N年M月」顯示；左對齊。
    - 收件人/地址/主旨/說明：文字；左對齊；多行內容保留換行。
  - 列印
    - 版面與行距依照頁面預覽，列印不含操作列與切換器。
  - 錯誤訊息鍵（若預覽內容生成失敗）
    - ERR_LETTER_DATA_MISSING：核定函資料不足。
    - ERR_FORMAT_NUMBER：金額格式錯誤。
    - ERR_FORMAT_DATE：日期格式錯誤（YYYMMDD）。

- 請領核發資料（op6_edit4.html）
  - 抬頭區（唯讀）
    - 受理編號: `#display-case-id`
    - 勞工姓名: `#display-laborer-name`
    - 勞工身分證字號: `#display-laborer-id`
    - 勞工出生日期: `#display-laborer-dob`
    - 版次: `#display-version`
  - 明細區（唯讀表格）
    - 一次退休金記錄：
      - 欄位：
        - 申請日期/核發日期
        - 受理日期/核定金額
        - 死亡日期/實發金額
        - 受理編號/補發金額
        - 請領人姓名/補件日期-註記
        - 提繳年資/不予核發日期-原因
        - 核定日期/其他註記
    - 月退休金記錄：
      - 欄位：
        - 申請日期/核發日期
        - 本局收到日期/首發核定金額
        - 受理日期/實發金額
        - 受理編號/補件日期-註記
        - 核定起迄年月/不給付日期-原因
        - 月退休金金額/其他註記
        - 核定日期/結案日期
    - 其他必要區塊依原型呈現（均為顯示，不可編輯）
  - 欄位格式與對齊（一次/月退共用原則）
    - 日期（申請、核發、受理、核定、結案、本局收到）：民國年月日 `YYYMMDD`；右對齊；空白顯示空值。
    - 年月範圍（核定起迄年月）：民國年月 `YYYMM–YYYMM`；右對齊。
    - 金額（核定金額、實發金額、補發金額、月退休金金額）：金額；千分位顯示；右對齊；允許 0。
    - 受理編號/請領人姓名：文字；左對齊。
    - 複合欄（日期-原因 或 日期-註記）：以「日期（YYYMMDD） / 原因(註記)」顯示；日期可空。
    - 提繳年資：顯示為「N年M月」；左對齊。
  - 分頁／排序／篩選
    - 分頁：每頁 20 筆（可調 10/20/50）。
    - 排序：支援表頭點擊排序；日期/年月與金額採型別排序；文字欄位字典序。
    - 篩選：
      - 日期範圍：申請日期、核定日期、核發日期、結案日期、受理日期；月退另含「本局收到日期」。
      - 年月範圍：核定起迄年月（起、迄）。
      - 關鍵字：受理編號、請領人姓名。
  - 錯誤訊息鍵
    - ERR_DATE_FORMAT：日期格式錯誤（YYYMMDD）。
    - ERR_YEARMONTH_FORMAT：年月格式錯誤（YYYMM）。
    - ERR_AMOUNT_FORMAT：金額格式錯誤。
    - ERR_RANGE_INVALID：起訖區間不合法（起大於迄）。
    - ERR_PAGE_BOUNDS：頁碼超出範圍。

- 請領其他給付資料（op6_edit5.html）
  - 抬頭區（唯讀）
    - 受理編號: `#display-case-id`
    - 勞工姓名: `#display-laborer-name`
    - 勞工身分證字號: `#display-laborer-id`
    - 勞工出生日期: `#display-laborer-dob`
    - 版次: `#display-version`
  - 明細區（唯讀表格）
    - 請領一次退休金記錄：
      - 欄位：
        - 申請日期/核發日期
        - 受理日期/核定金額
        - 死亡日期/實發金額
        - 受理編號/補發金額
        - 請領人姓名/補件日期-註記
        - 提繳年資/不予核發日期-原因
        - 核定日期/其他註記
    - 請領月退休金記錄：
      - 欄位：
        - 申請日期/核發日期
        - 本局收到日期/首發核定金額
        - 受理日期/實發金額
        - 受理編號/補件日期-註記
        - 核定起迄年月/不給付日期-原因
        - 月退休金金額/其他註記
        - 核定日期/結案日期
    - 請領勞保一次金給付記錄（含 31、41）：
      - 欄位：
        - 受理日期/受款人姓名
        - 事故日期/補件日期-註記
        - 受理編號/不給付日期-原因
        - 失能等級/應收註記
        - 給付種類/補發金額
        - 核定日期/帳號
        - 核付日期/專戶註記
        - 核付金額
    - 請領勞保年金給付記錄：
      - 欄位：
        - 受理日期/人數
        - 事故日期/核定月數
        - 受理編號/補件日期-註記
        - 核定日期/不給付日期
        - 核付日期/不給付原因
        - 核付金額/補發金額
        - 受款人姓名/帳號
        - 身份證號/保險證號
        - 出生日期
    - 請領國保身心障年金給付記錄：
      - 欄位：
        - 受理日期/人數
        - 事故日期/核定月數
        - 受理編號/補件日期-註記
        - 核定日期/不給付日期
        - 核付日期/不給付原因
        - 核付金額/補發金額
        - 受款人姓名/帳號
        - 身份證號/保險證號
        - 出生日期
    - 請領農保給付資料：
      - 欄位：
        - 受理日期/人數
        - 事故日期/核定月數
        - 受理編號/補件日期-註記
        - 核定日期/不給付日期
        - 核付日期/不給付原因
        - 核付金額/補發金額
        - 受款人姓名/帳號
        - 身份證號/保險證號
        - 出生日期
  - 欄位格式與對齊（各表共用原則）
    - 日期（申請、核發、受理、核定、結案、核付、事故、補件、不給付）：民國年月日 `YYYMMDD`；右對齊；空白顯示空值。
    - 年月（核定月數除外）：民國年月 `YYYMM`；右對齊。
    - 人數、核定月數：整數；右對齊。
    - 金額（核定金額、實發金額、補發金額、核付金額）：金額；千分位顯示；右對齊；允許 0；可視需求允許負值（如沖銷）。
    - 受理編號/姓名/帳號/保險證號/身份證號：文字；左對齊。
    - 複合欄（日期-原因、日期-註記）：以「日期（YYYMMDD） / 內容」顯示；日期可空。
  - 分頁／排序／篩選
    - 分頁：每頁 20 筆（可調 10/20/50）。
    - 排序：支援表頭點擊排序；日期、金額、整數與文字按型別排序。
    - 篩選：
      - 日期範圍：受理、核定、核發/核付、事故、補件、不給付、結案。
      - 關鍵字：受理編號、姓名（請領/受款人）、身份證號、保險證號、帳號。
      - 類別：給付種類、失能等級、是否專戶註記。
  - 錯誤訊息鍵
    - ERR_DATE_FORMAT：日期格式錯誤（YYYMMDD）。
    - ERR_YEARMONTH_FORMAT：年月格式錯誤（YYYMM）。
    - ERR_INT_FORMAT：整數格式錯誤（人數/核定月數）。
    - ERR_AMOUNT_FORMAT：金額格式錯誤。
    - ERR_RANGE_INVALID：起訖區間不合法（起大於迄）。
    - ERR_PAGE_BOUNDS：頁碼超出範圍。

- 勞退個人異動查詢（op6_edit6.html）
  - 抬頭區（唯讀）
    - 受理編號: `#display-case-id`
    - 勞工姓名: `#display-laborer-name`
    - 勞工身分證字號: `#display-laborer-id`
    - 勞工出生日期: `#display-laborer-dob`
    - 版次: `#display-version`
  - 清單檢視（唯讀表格）
    - 清單 tbody: `#list-view-body`
    - 分頁元件容器: `#list-pagination-container`
    - 清單欄位：
      - 提繳編號
      - 異動別
      - 生效日
      - 提繳工資
      - 身部（頁面以「身　　部＊」呈現）
      - 雇提率％／個提率％
      - 計費年月
      - 異動原因
      - 鍵入代號
      - 更新日
  - 明細檢視（唯讀）
    - 明細容器: `#detail-view`（內含基本資料、投保明細、提繳異動等，依原型呈現）
    - 明細表格欄位（提繳編號不再重複顯示）：
      - 異動別
      - 生效日
      - 提繳工資
      - 身部（頁面以「身　　部＊」呈現）
      - 雇提率％／個提率％
      - 計費年月
      - 異動原因
      - 鍵入代號
      - 更新日
  - 欄位格式與對齊（清單/明細一致）
    - 提繳編號：文字；左對齊。
    - 異動別：文字（代碼/敘述）；左對齊。
    - 生效日：民國年月日 `YYYMMDD`；右對齊；無值顯示空白。
    - 提繳工資：整數/金額；千分位顯示；右對齊；空白視為 0 不顯示 0。
    - 身部：文字；左對齊。
    - 雇提率％／個提率％：數值最多小數2位；以「雇提率% 個提率%」方式顯示於同一欄；右對齊；範圍 0–100。
    - 計費年月：民國年月 `YYYMM`；右對齊；無值顯示空白。
    - 異動原因：文字；左對齊。
    - 鍵入代號：文字（代碼）；左對齊。
    - 更新日：民國年月日 `YYYMMDD`；右對齊；無值顯示空白。
  - 分頁／排序／篩選
    - 分頁：每頁 20 筆（可調 10/20/50）；顯示目前頁次與總頁數；切換頁面時保留目前排序與篩選條件。
    - 排序：點擊表頭切換升冪/降冪；依欄型自動判斷比較方式（日期/年月、數值、文字）。
    - 篩選：提供關鍵字篩選（提繳編號、異動別、異動原因）以及日期/年月範圍（生效日、計費年月）。
  - 錯誤訊息鍵（Validation/Error Keys）
    - ERR_DATE_FORMAT：日期格式錯誤（應為民國年月日 YYYMMDD）。
    - ERR_YEARMONTH_FORMAT：年月格式錯誤（應為民國年月 YYYMM）。
    - ERR_PERCENT_RANGE：百分比超出範圍（0–100）。
    - ERR_NUMBER_FORMAT：數字格式錯誤（僅允許數字與小數點）。
    - ERR_PAGE_BOUNDS：頁碼超出範圍。

- 個人專戶明細資料（op6_edit7.html）
  - 抬頭區（唯讀）
    - 受理編號: `#display-case-id`
    - 勞工姓名: `#laborerName`
    - 勞工身分證字號: `#laborerId`
    - 勞工出生日期: `#laborerDob`
    - 版次: `#version`
  - 統計資訊（唯讀）
    - 已繳納金額: `#total-paid`
    - 收益累計: `#total-earnings`
  - 表格明細（唯讀，兩段內容欄位相同）：
    - 計費年月
    - 摘要說明
    - 資料時段
    - 繳納單位編號
    - 應計退休金
    - 金額
    - 繳納日期
    - 處理日期
    - 收益分配年度
  - 欄位格式與對齊
    - 計費年月：民國年月 `YYYMM`；右對齊。
    - 摘要說明：文字；左對齊；過長以省略號處理並提供 title 提示。
    - 資料時段：文字（含區間，如 YYYMMDD–YYYMMDD）；左對齊。
    - 繳納單位編號：文字；左對齊。
    - 應計退休金：金額；千分位顯示；右對齊；可為 0。
    - 金額：金額；千分位顯示；右對齊；可為 0 或負值（如沖銷）。
    - 繳納日期：民國年月日 `YYYMMDD`；右對齊；無值顯示空白。
    - 處理日期：民國年月日 `YYYMMDD`；右對齊；無值顯示空白。
    - 收益分配年度：民國年 `YYY`；右對齊。
  - 分頁／排序／篩選
    - 分頁：每頁 20 筆（可調 10/20/50）。
    - 排序：支援單欄排序；預設依「計費年月」降冪；金額欄以數值排序。
    - 篩選：提供年月篩選（計費年月）、單位編號關鍵字、摘要關鍵字，以及日期範圍（繳納日期/處理日期）。
  - 錯誤訊息鍵（Validation/Error Keys）
    - ERR_YEARMONTH_FORMAT：年月格式錯誤（應為民國年月 YYYMM）。
    - ERR_DATE_FORMAT：日期格式錯誤（應為民國年月日 YYYMMDD）。
    - ERR_AMOUNT_FORMAT：金額格式錯誤（允許負數，必須為有效數字）。
    - ERR_PAGE_BOUNDS：頁碼超出範圍。

## 原型需同步事項（Worklist）
- 基本資料頁「民法繼承案件」顯示條件
  - Prototype 調整為僅 51/52/53 顯示（且需有「勞工死亡日期」），與文件/MD 一致。
- 受款人頁「核發方式」即時限制
  - 緊急=專案處理 → 核發方式清單僅顯示 7-緊急電匯；若原先選到非 7，立即提示並重置。
  - 專戶註記=已提供 → 僅 1/2；專戶註記=申請 → 僅 A；不符時即時提示並重置。
  - 上述限制需在來源欄位變更當下即時檢核與回饋（提交前再整體檢核）。
- 受款人頁「方式=1」帳號第二段
  - 第二段固定顯示 0000 且不可修改（禁用或改以唯讀文字呈現）。
- 受款人頁「地址」欄位啟用規則
  - 進入維護區預設「戶籍地址」→ 所有地址欄位唯讀；切換「現住址」→ 啟用並視為必填；切回戶籍→ 恢復唯讀且清除錯誤。
- 受款人刪除後流程
  - 刪除成功→重排序號；不自動重新編審，僅引導按「確認」（提交前列印/審核受 dirty 阻擋）。
- 金額分割（Modal）檢核與回寫
  - 只檢核「分配金額加總=可分配總額」，不檢核百分比；確認後回寫列表並標記 dirty，需按「確認」完成重新編審。
- 唯讀頁工具列顯示
  - 核定函/請領核發資料/請領其他給付資料/勞退個人異動/個人專戶明細 等唯讀頁僅顯示「頁面(或pdf)列印/返回」，隱藏確認/審核/清單列印。

## 版本與文件連結
- [需求彙整]: `3.更正作業/更正作業需求說明_all.md`
- [基本資料需求]: `3.更正作業/更正作業需求說明_基本資料.md`
- [受款人需求]: `3.更正作業/更正作業需求說明_受款人.md`
- [原型頁面]: `3.更正作業/op6.html`、`3.更正作業/op6_edit.html`～`op6_edit8.html`
- [流程圖]: `3.更正作業/更正作業-活動圖.svg`
- [循序圖]: `3.更正作業/循序圖-更正作業.svg`

## 變更紀錄
- v0.1：依文件與原型整理，未加入文件外之內容。
## 欄位出現條件整理（依 data-claim-type-show）
- 31: 提前請領退休金
- 32: 提前請領月退休金
- 41: 一次退休金
- 42: 月退休金
- 43: 續提退休金
- 46: 續提月退休金
- 51: 死亡退休金
- 52: 月退死亡退休金
- 53: 死亡退休金(含月退)

以上各欄位的「可見」註記，完全對應至 HTML 上的 `data-claim-type-show="..."` 標註，不做額外推論或合併規則。
## 差異清單（與 Prototype 與 Word 版需求分析報告比對）

以下差異以本檔（更正作業.MD）為基準，對照 Prototype（op6/op6_edit*.html）與 Word（更正作業-需求分析報告-20250807.docx）。

**條件與限制**
- 狀態可更正條件: 本檔/Prototype含「月退休金案續發案件執行整批續發作業前」；Word多為概念敘述，未逐條展開一致。
- 整批續發限制: 本檔明列 32/42/46/52/53 已執行整批續發不可更正；Word未明訂；Prototype示例訊息模擬，尚未接後端檢核。
- 狀態不符訊息: 本檔/Prototype為「本案件無法進行更正，請確認案件狀態」；Word多處僅寫「本案件無法進行更正」。

**UI 與文案**
- 查詢頁按鈕: Prototype文案為「清空」；本檔備註將調整為「清除」；Word多處使用「清除」。
- 繼承案件 Checkbox 顯示: 本檔/Prototype規定「僅 51/52/53 且有勞工死亡日期時顯示」；Word僅寫「涉及民法繼承則引導」，未載明顯示條件。
- 金額分割按鈕: Prototype於受款人頁籤且 51/52/53 才顯示；本檔有規則描述；Word未規範顯示條件。
- 版面原則: 本檔要求禁用 Bootstrap 欄位排版、採一列三欄與 `.size-auto`；Prototype以客製 flex 實作；Word未明列「禁用 Bootstrap/三欄固定」。

**流程與互動**
- 分頁切換儲存: 本檔定義「可部分成功」並切換後帶最新資料；Prototype有切換即儲存（sessionStorage）但未做「部分成功」與欄位級錯誤提示；Word描述「暫存」，未定義部分成功與切換時機。
- 勾選繼承案件引導: 本檔/Prototype規範「勾選且無繼承人時自動導至受款人新增」；Word僅高層級描述，未明確觸發時機。
- 查詢頁導頁資料: 本檔規格化傳遞 `請領種類/受理編號`；Prototype以 URL 參數實作；Word未技術化說明。
- 未儲存離開提醒: 本檔補強「返回/其他動作前需提示未提交變更」；Prototype直接返回 `op6.html`；Word未規範。

**日誌與版本**
- 更正日誌內容: 本檔詳列欄位差異、批次ID、操作類型（auto-save/submit）、操作者與時間；Prototype未實作；Word僅高層級提及「記錄更正日誌」。
- 版本與併發: 本檔要求樂觀鎖、版本不符提示與分頁儲存納入檢核；Prototype僅示意版次+1；Word未描述併發控制。
- 提交行為: 本檔規範三頁籤整體驗證、單一交易全有全無、成功訊息與可能背景處理；Prototype以 confirm+版本+1 模擬；Word UC-10 有「版次+1、返回提示」，但未述交易/回滾細節。
- 列印可用條件: 本檔規定「受理審核清單列印」需提交成功（版次+1）才啟用；Prototype按鈕目前未加條件；Word未寫可用門檻。

**欄位與檢核**
- 日期規則: 本檔補強民國 7 碼、閏年、先後順序、不得晚於系統日與跨欄邏輯；Prototype僅少量前端驗證示範；Word未細述。
- 身分證/數字檢核: 本檔含本國證號格式與檢核碼、金額不得負值等；Prototype部分欄位處理；Word未具體化。
- 查詢頁錯誤處理: 三份對「查無可更正的案件資料」一致；對「受理編號錯誤」檢核規則一致（3-1-2-6；第5段選填需兩碼），但 Word未提自動跳欄焦點互動細節。

**頁面與命名**
- 版型參考命名: 本檔/Prototype統一使用 `op6/op6_edit*.html`；來源其他 Markdown 檔仍見 `op38/op38_1` 舊稱；Word未涉及檔名，建議整體參考更新為 `op6*`。

【建議對齊】
- 文案統一: 查詢頁按鈕統一「清空」或「清除」（擇一並同步三份）。
- 狀態條件: 來源分檔（基本/受款人）補齊「月退休金案續發案件執行整批續發作業前」；錯誤訊息統一加尾句「請確認案件狀態」。
- 繼承案件條件: 三份統一為「請領種類 51/52/53 且死亡日期有值時顯示」，無繼承人自動跳受款人。
- 按鈕門檻: 「受理審核清單列印」需提交成功（版次+1）才啟用；Prototype 加上 disabled/提示。
- 規格補強: 將本檔的日期/身分證/更正日誌/樂觀鎖等細則納入 Word；或明訂本檔為單一事實來源。
- 版型檔名: 來源分檔更新為 `op6_edit*.html`，避免歧義。
